<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cash Flow Forecasting Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --az-mulberry: #830051;
            --az-lime: #C4D600;
            --az-navy: #003865;
            --az-graphite: #3F4444;
            --az-light-blue: #68D2DF;
            --az-magenta: #D0006F;
            --az-purple: #3C1053;
            --az-gold: #F0AB00;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: var(--az-graphite);
            line-height: 1.6;
        }

        .dashboard-header {
            background: linear-gradient(135deg, var(--az-mulberry) 0%, var(--az-purple) 100%);
            color: white;
            padding: 2rem 3rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
        }

        .dashboard-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .dashboard-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .nav-bar {
            background: white;
            padding: 1rem 3rem;
            border-bottom: 3px solid var(--az-mulberry);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .nav-label {
            font-weight: 600;
            color: var(--az-mulberry);
            margin-right: 1rem;
        }

        .nav-link {
            padding: 0.5rem 1.2rem;
            background: #f1f3f4;
            border-radius: 25px;
            text-decoration: none;
            color: var(--az-graphite);
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: var(--az-mulberry);
            color: white;
            transform: translateY(-2px);
        }

        .main-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Executive Summary */
        .executive-summary {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .summary-title {
            font-size: 1.5rem;
            color: var(--az-mulberry);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .summary-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 12px;
            background: linear-gradient(145deg, #f8f9fa, #ffffff);
            border: 1px solid #e9ecef;
        }

        .summary-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .summary-label {
            font-size: 0.9rem;
            color: #6c757d;
            font-weight: 500;
        }

        /* Methodology Section */
        .methodology {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .methodology h2 {
            color: var(--az-mulberry);
            margin-bottom: 1rem;
        }

        .methodology-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .method-card {
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--az-mulberry);
            background: #f8f9fa;
        }

        .method-card h4 {
            color: var(--az-navy);
            margin-bottom: 0.5rem;
        }

        .method-card p {
            font-size: 0.95rem;
            color: #555;
        }

        /* Entity Section */
        .entity-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .entity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .entity-header h2 {
            font-size: 1.75rem;
            color: var(--az-graphite);
        }

        .entity-badge {
            background: var(--az-mulberry);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 8px;
            font-size: 1.2rem;
        }

        .model-badge {
            background: var(--az-light-blue);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        /* KPI Cards */
        .kpi-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .kpi-card {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            border: 1px solid #e9ecef;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .kpi-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .kpi-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .kpi-label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-container {
            background: #fafbfc;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
        }

        .chart-container.full-width {
            grid-column: 1 / -1;
        }

        .chart-container h3 {
            font-size: 1.1rem;
            color: var(--az-navy);
            margin-bottom: 0.5rem;
        }

        .chart-description {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 1rem;
        }

        .chart {
            width: 100%;
            min-height: 300px;
        }

        .metrics-row {
            display: flex;
            gap: 1.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e9ecef;
            flex-wrap: wrap;
        }

        .metric {
            display: flex;
            flex-direction: column;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #6c757d;
            text-transform: uppercase;
        }

        .metric-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--az-navy);
        }

        /* Insight Box */
        .insight-box {
            background: #f8f9fa;
            border-left: 4px solid var(--az-mulberry);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
            margin-top: 1rem;
        }

        .insight-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            color: white;
            font-weight: 600;
        }

        /* Category Analysis */
        .category-analysis {
            margin-bottom: 2rem;
        }

        .category-analysis h3 {
            color: var(--az-navy);
            margin-bottom: 1rem;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .category-box {
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }

        .category-box.inflow {
            background: linear-gradient(145deg, rgba(196, 214, 0, 0.1), rgba(196, 214, 0, 0.05));
            border-left: 4px solid var(--az-lime);
        }

        .category-box.outflow {
            background: linear-gradient(145deg, rgba(208, 0, 111, 0.1), rgba(208, 0, 111, 0.05));
            border-left: 4px solid var(--az-magenta);
        }

        .category-box h4 {
            margin-bottom: 1rem;
            color: var(--az-graphite);
        }

        .category-box ul {
            list-style: none;
        }

        .category-box li {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px dashed #e9ecef;
        }

        .cat-name {
            font-weight: 500;
        }

        .cat-value {
            font-weight: 600;
        }

        /* Monthly Breakdown */
        .monthly-breakdown {
            background: #fafbfc;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid #e9ecef;
        }

        .monthly-breakdown h3 {
            color: var(--az-navy);
            margin-bottom: 0.5rem;
        }

        .monthly-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .monthly-card {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .monthly-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .monthly-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .month-badge {
            padding: 0.25rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            color: white;
            font-weight: 600;
        }

        .month-dates {
            font-size: 0.7rem;
            color: #6c757d;
        }

        .monthly-stats {
            display: flex;
            justify-content: space-between;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .monthly-stat {
            text-align: center;
            flex: 1;
        }

        .stat-value {
            display: block;
            font-size: 1rem;
            font-weight: 700;
            color: var(--az-navy);
        }

        .stat-label {
            font-size: 0.65rem;
            color: #6c757d;
            text-transform: uppercase;
        }

        .weekly-detail {
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .week-val {
            font-size: 0.65rem;
            padding: 0.15rem 0.4rem;
            background: #f1f3f4;
            border-radius: 4px;
            font-weight: 500;
        }

        /* Model Table */
        .model-comparison {
            margin-bottom: 1rem;
        }

        .model-comparison h3 {
            color: var(--az-navy);
            margin-bottom: 1rem;
        }

        .model-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        .model-table th {
            background: var(--az-navy);
            color: white;
            padding: 0.75rem;
            text-align: left;
        }

        .model-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e9ecef;
        }

        .model-table tr:hover {
            background: #f8f9fa;
        }

        .model-table .best-model {
            background: rgba(196, 214, 0, 0.2);
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            .dashboard-header {
                padding: 1.5rem;
            }
            .dashboard-title {
                font-size: 1.75rem;
            }
        }

        /* Print styles */
        @media print {
            .nav-bar { display: none; }
            .entity-section { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <header class="dashboard-header">
        <div class="header-content">
            <h1 class="dashboard-title">üí∞ Cash Flow Forecasting Dashboard</h1>
            <p class="dashboard-subtitle">Time-Series Analysis & ML-Based Predictions | Generated: 2025-12-19 23:21</p>
        </div>
    </header>

    <nav class="nav-bar">
        <div class="nav-content">
            <span class="nav-label">Jump to Entity:</span>
            <a href="#TW10" class="nav-link">TW10</a><a href="#PH10" class="nav-link">PH10</a><a href="#TH10" class="nav-link">TH10</a><a href="#ID10" class="nav-link">ID10</a><a href="#SS10" class="nav-link">SS10</a><a href="#MY10" class="nav-link">MY10</a><a href="#VN20" class="nav-link">VN20</a><a href="#KR10" class="nav-link">KR10</a>
        </div>
    </nav>

    <main class="main-content">
        <!-- Executive Summary -->
        <section class="executive-summary">
            <h2 class="summary-title">üìä Executive Summary</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-value" style="color: var(--az-navy)">8</div>
                    <div class="summary-label">Entities Analyzed</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value" style="color: var(--az-lime)">$127.27M</div>
                    <div class="summary-label">Total Inflows</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value" style="color: var(--az-magenta)">$131.18M</div>
                    <div class="summary-label">Total Outflows</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value" style="color: var(--az-mulberry)">$-3.92M</div>
                    <div class="summary-label">Net Position</div>
                </div>
            </div>
        </section>

        <!-- Methodology Section -->
        <section class="methodology">
            <h2>üìö Forecasting Methodology</h2>
            <div class="methodology-grid">
                <div class="method-card">
                    <h4>üéØ Model Selection</h4>
                    <p>We employ an ensemble of ML models including <strong>XGBoost</strong>, <strong>LightGBM</strong>, <strong>Random Forest</strong>, <strong>Gradient Boosting</strong>, and <strong>Ridge Regression</strong>. The best model is selected based on lowest RMSE during backtesting.</p>
                </div>
                <div class="method-card">
                    <h4>üìà Key Features</h4>
                    <p>Models use <strong>lag features</strong> (1, 2, 4 weeks), <strong>rolling statistics</strong> (4-week mean/std), <strong>temporal patterns</strong> (week of month, quarter), and <strong>transaction counts</strong> to capture cash flow dynamics.</p>
                </div>
                <div class="method-card">
                    <h4>üîç Backtest Validation</h4>
                    <p>The last <strong>4 weeks</strong> are held out for backtesting. We measure accuracy using MAE, RMSE, MAPE, and direction accuracy to ensure reliable forecasts.</p>
                </div>
                <div class="method-card">
                    <h4>‚ö†Ô∏è Limitations</h4>
                    <p>Forecasts assume historical patterns continue. External shocks, policy changes, or market disruptions may cause deviations. Longer horizons have higher uncertainty.</p>
                </div>
            </div>
        </section>

        <!-- Entity Sections -->
        
        <div class="entity-section" id="TW10">
            <div class="entity-header">
                <h2><span class="entity-badge">TW10</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>GradientBoosting</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$29.70M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$28.56M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$1.14M</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$5.42M</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-TW10" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$647.5K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$852.4K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">61.0%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">66.7%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-TW10" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on GradientBoosting model.</p>
                    <div id="short-forecast-TW10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #C4D600">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #C4D600">‚úÖ Stable</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Healthy cash position expected. Net inflow forecast: $5.42M</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-TW10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #C4D600">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #C4D600">Sustainable</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $5.88M. Position appears sustainable.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$2.68M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$2.68M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$379.3K</span><span class="week-val" style="color: #22c55e">$91.1K</span><span class="week-val" style="color: #22c55e">$380.5K</span><span class="week-val" style="color: #22c55e">$1.83M</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$2.66M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$5.34M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$264.8K</span><span class="week-val" style="color: #22c55e">$249.7K</span><span class="week-val" style="color: #22c55e">$1.06M</span><span class="week-val" style="color: #22c55e">$1.09M</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$648.0K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$5.99M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$117.6K</span><span class="week-val" style="color: #22c55e">$419.3K</span><span class="week-val" style="color: #22c55e">$10.9K</span><span class="week-val" style="color: #22c55e">$100.2K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-2.13M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$3.86M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-124.7K</span><span class="week-val" style="color: #ef4444">$-486.8K</span><span class="week-val" style="color: #ef4444">$-411.8K</span><span class="week-val" style="color: #ef4444">$-1.10M</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$1.04M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$4.91M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$1.87M</span><span class="week-val" style="color: #22c55e">$81.0K</span><span class="week-val" style="color: #ef4444">$-294.4K</span><span class="week-val" style="color: #ef4444">$-617.6K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$971.2K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$5.88M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-463.7K</span><span class="week-val" style="color: #22c55e">$2.01M</span><span class="week-val" style="color: #ef4444">$-81.0K</span><span class="week-val" style="color: #ef4444">$-490.4K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-TW10" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">AR</span><span class="cat-value">$28.67M</span></li><li><span class="cat-name">Loan receipt</span><span class="cat-value">$975.4K</span></li><li><span class="cat-name">Other receipt</span><span class="cat-value">$47.0K</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Bank charges</span><span class="cat-value">-$467</span></li><li><span class="cat-name">Interest charges</span><span class="cat-value">-$14.3K</span></li><li><span class="cat-name">Payroll</span><span class="cat-value">-$1.81M</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td>RandomForest </td>
                            <td>$805.8K</td>
                            <td>$1.07M</td>
                            <td>64.5</td>
                            <td>66.7</td>
                        </tr><tr class="best-model">
                            <td>GradientBoosting ‚≠ê</td>
                            <td>$647.5K</td>
                            <td>$852.4K</td>
                            <td>61.0</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>Ridge </td>
                            <td>$1.22M</td>
                            <td>$1.34M</td>
                            <td>230.8</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>Ensemble </td>
                            <td>$827.2K</td>
                            <td>$924.1K</td>
                            <td>96.1</td>
                            <td>66.7</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-TW10', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-203958.99148000003, -614642.0331799999, -2150738.1343, 2864292.22503],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-397710.97646657925, -980457.790332641, -555237.3541471851, 2429285.46821079],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-TW10', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [166644.08336, 27.34836, 1102.4413499999998, 0.0, 2334787.87957, 13.69032, 2335.08, 1235.5844, 2666161.9679, 189.53815, 858.10096, 694.46256, 225187.71999999997, 3296156.5662599998, 1161.14708, 5.14738, 514.09906, 2581727.55847, 312.5137, 605.92714, 6862.13867, 2513844.4273000006, 178455.47777, 243.10150000000002, 475.73, 2835648.71, 187773.57632, 16.656, 3674.48138, 1213.0322800000001, 3077678.8701099996, 20.91896, 420.82640000000004, 2230.0141200000003, 3021602.34708, 176761.07105, 975436.3655000001, 0.0, 2365591.8772199997, 189805.46666, 1845.18374, 91.1, 2506.7245599999997, 2873769.09],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-83639.05167, -362386.95074999996, -360737.2353, -0.0, -2614280.92698, -183789.34934000002, -74821.14306999999, -1772556.3366999999, -54448.101590000006, -128558.94627999997, -201421.39815, -438908.3866999999, -2165568.28286, -19299.7011, -340207.85092999996, -242175.93814000004, -1844293.1115299999, -67138.29164, -201058.05842000002, -422821.6809599999, -1117512.4400000002, -1158401.43648, -157098.48804999999, -413109.71314, -92656.37594, -991330.7077899999, -881288.8911199999, -221563.54911999998, -349779.84284999996, -2096536.14058, -99464.87687, -342165.17441000004, -113773.50045999998, -335550.6645400001, -105993.86976, -198176.30142000003, -158489.91214000003, -3509570.2616700004, -1523681.3734900001, -130900.05998, -205804.17522, -614733.13318, -2153244.85886, -9476.864969999999],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [83005.03168999997, -362359.60239, -359634.79394999996, 0.0, -279493.04741000035, -183775.65902000002, -72486.06307, -1771320.7522999998, 2611713.86631, -128369.40813, -200563.29719, -438213.92413999996, -1940380.5628599997, 3276856.86516, -339046.70385, -242170.79076000006, -1843779.01247, 2514589.26683, -200745.54472, -422215.75381999987, -1110650.3013300002, 1355442.9908200004, 21356.989719999983, -412866.61164, -92180.64594, 1844318.0022099996, -693515.3147999999, -221546.89312000002, -346105.36147, -2095323.1082999997, 2978213.9932399997, -342144.25545000006, -113352.67405999999, -333320.65042, 2915608.47732, -21415.230369999997, 816946.4533600002, -3509570.2616700004, 841910.5037299998, 58905.406679999985, -203958.99148000003, -614642.0331799999, -2150738.1343, 2864292.22503],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = 2864292.22503;
        Plotly.newPlot('short-forecast-TW10', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [816946.4533600002, -3509570.2616700004, 841910.5037299998, 58905.406679999985, -203958.99148000003, -614642.0331799999, -2150738.1343, 2864292.22503],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([631693.5184046149, 124429.64115972191, -160229.019220037, 4826560.199420514]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-113352.67405999999, -333320.65042, 2915608.47732, -21415.230369999997, 816946.4533600002, -3509570.2616700004, 841910.5037299998, 58905.406679999985, -203958.99148000003, -614642.0331799999, -2150738.1343, 2864292.22503],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [379264.3523960343, 91145.72932704866, 380468.4870747628, 1828573.041336652], "total": 2679451.6101344978, "cumulative": 2679451.6101344978, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [264800.80465109844, 249666.41511944373, 1060414.7215490316, 1089241.151235335], "total": 2664123.0925549087, "cumulative": 5343574.702689406, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [117645.30815425894, 419267.6105888216, 10873.429377415188, 100203.85260592497], "total": 647990.2007264206, "cumulative": 5991564.903415827, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [-124742.69056524675, -486764.7883846239, -411834.6730836618, -1103673.232205278], "total": -2127015.3842388103, "cumulative": 3864549.519177017, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [1872334.8864791796, 80958.77491113367, -294419.6977999872, -617591.5844578353], "total": 1041282.3791324907, "cumulative": 4905831.898309507, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [-463654.1440773681, 2006275.4824518017, -80992.45288806416, -490388.981068023], "total": 971239.9044183464, "cumulative": 5877071.802727854, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-TW10', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-TW10', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        
        <div class="entity-section" id="PH10">
            <div class="entity-header">
                <h2><span class="entity-badge">PH10</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>Ridge</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$6.25M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$6.87M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$-617.6K</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$-194.4K</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-PH10" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$90.4K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$125.3K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">48.5%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">66.7%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-PH10" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on Ridge model.</p>
                    <div id="short-forecast-PH10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">‚ö†Ô∏è At Risk</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Expected net outflow of $194.4K over the next month. Monitor closely.</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-PH10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">Needs Attention</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $-241.3K. Consider strategic adjustments.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$37.3K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$37.3K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$31.9K</span><span class="week-val" style="color: #ef4444">$-74.3K</span><span class="week-val" style="color: #ef4444">$-12.1K</span><span class="week-val" style="color: #22c55e">$91.8K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-67.0K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-29.7K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-59.1K</span><span class="week-val" style="color: #ef4444">$-66.8K</span><span class="week-val" style="color: #22c55e">$43.8K</span><span class="week-val" style="color: #22c55e">$15.2K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$186.9K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$157.2K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-65.0K</span><span class="week-val" style="color: #22c55e">$99.6K</span><span class="week-val" style="color: #22c55e">$81.6K</span><span class="week-val" style="color: #22c55e">$70.7K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$37.8K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$195.0K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$125.4K</span><span class="week-val" style="color: #ef4444">$-33.1K</span><span class="week-val" style="color: #ef4444">$-45.4K</span><span class="week-val" style="color: #ef4444">$-9.1K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-115.0K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$80.0K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$87.8K</span><span class="week-val" style="color: #ef4444">$-43.9K</span><span class="week-val" style="color: #ef4444">$-116.8K</span><span class="week-val" style="color: #ef4444">$-42.1K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-321.3K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-241.3K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$35.3K</span><span class="week-val" style="color: #ef4444">$-83.4K</span><span class="week-val" style="color: #ef4444">$-136.6K</span><span class="week-val" style="color: #ef4444">$-136.6K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-PH10" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">AR</span><span class="cat-value">$4.65M</span></li><li><span class="cat-name">Loan receipt</span><span class="cat-value">$1.34M</span></li><li><span class="cat-name">Other receipt</span><span class="cat-value">$257.8K</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Bank charges</span><span class="cat-value">-$160</span></li><li><span class="cat-name">Interest charges</span><span class="cat-value">-$2.4K</span></li><li><span class="cat-name">Custom and Duty</span><span class="cat-value">-$212.1K</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td>RandomForest </td>
                            <td>$140.7K</td>
                            <td>$168.1K</td>
                            <td>71.0</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>GradientBoosting </td>
                            <td>$151.5K</td>
                            <td>$176.8K</td>
                            <td>184.7</td>
                            <td>66.7</td>
                        </tr><tr class="best-model">
                            <td>Ridge ‚≠ê</td>
                            <td>$90.4K</td>
                            <td>$125.3K</td>
                            <td>48.5</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>Ensemble </td>
                            <td>$114.5K</td>
                            <td>$145.6K</td>
                            <td>82.7</td>
                            <td>100.0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-PH10', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [240962.47684, 19307.471809999985, -221092.87524000008, 233178.69207],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [8090.563087481536, 27740.34945815647, -135582.52608081076, 267929.5305895375],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-PH10', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [3636.57698, 1780.6658700000003, 6441.58752, 221117.47506, 198323.29903, 1042.6160599999998, 1955.70701, 276.10834, 462599.78418, 2596.12586, 3773.74468, 1134.6838799999998, 442221.61316, 614.2003500000001, 190.73497, 104.30187999999998, 304914.35731, 235298.16544, 93.42032, 489.26659000000006, 311614.45008999994, 240972.09278, 509.71734000000004, 246.28021999999999, 12643.999619999999, 600632.82603, 1371.0729600000002, 117.78515999999999, 905.07108, 371615.49174, 264923.58974, 328.85069999999996, 527.28038, 382886.39396, 231067.91504, 390852.00930999994, 269824.93858, 2223.0181399999997, 252510.64244, 197844.97775999998, 338889.73121999996, 67630.54534, 177032.87008999998, 246917.12504999997],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-43021.04595, -69294.94095, -56350.62339, -412208.8749899999, -26814.72728, -35511.6938, -54663.34735, -43676.44861, -313744.17092000006, -41875.56107, -133824.81153, -26034.695099999997, -451240.24267, -27222.886759999998, -130104.45175999998, -122609.45186000003, -395417.4623100001, -203620.49598999997, -93541.52394, -72363.5722, -277012.42223, -188975.86815, -85133.28754, -66722.49844, -24448.590269999997, -205055.18575, -32394.142249999997, -139074.43515, -33233.06898, -588166.00464, -20257.1664, -103177.39275999999, -20342.375459999996, -195847.87080999996, -593635.5166, -326689.11723000003, -73472.19012000001, -81629.94299000001, -146909.0012, -356862.51316000003, -97927.25437999998, -48323.07353, -398125.74533, -13738.432980000001],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-39384.46897, -67514.27508, -49909.03587, -191091.39993, 171508.57175, -34469.07774, -52707.64033999999, -43400.34027, 148855.61326000004, -39279.435209999996, -130051.06684999997, -24900.01122, -9018.62951000005, -26608.68641, -129913.71679, -122505.14998000002, -90503.10500000001, 31677.669449999994, -93448.10362000001, -71874.30561, 34602.02785999999, 51996.22462999995, -84623.5702, -66476.21822, -11804.590650000002, 395577.64027999993, -31023.06929, -138956.64999, -32327.997900000002, -216550.5129, 244666.42333999998, -102848.54206, -19815.09508, 187038.52315000002, -362567.60156000004, 64162.89208000003, 196352.74845999997, -79406.92485, 105601.64124, -159017.5354, 240962.47684, 19307.471809999985, -221092.87524000008, 233178.69207],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = 233178.69207;
        Plotly.newPlot('short-forecast-PH10', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [196352.74845999997, -79406.92485, 105601.64124, -159017.5354, 240962.47684, 19307.471809999985, -221092.87524000008, 233178.69207],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([4148.838621858515, -213523.1097181729, -96747.09687773221, 111755.25650345924]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-19815.09508, 187038.52315000002, -362567.60156000004, 64162.89208000003, 196352.74845999997, -79406.92485, 105601.64124, -159017.5354, 240962.47684, 19307.471809999985, -221092.87524000008, 233178.69207],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [31900.92831773598, -74336.23015702986, -12051.75818772722, 91827.34879053701], "total": 37340.28876351591, "cumulative": 37340.28876351591, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [-59128.299810281605, -66819.533761686, 43755.901645314545, 15187.821542180456], "total": -67004.11038447262, "cumulative": -29663.821620956704, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [-64985.31470144233, 99573.94966535465, 81558.2045817386, 70742.87098138106], "total": 186889.71052703197, "cumulative": 157225.88890607527, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [125395.24286376058, -33143.55810956427, -45357.33816862684, -9120.385059643311], "total": 37773.961525926155, "cumulative": 194999.85043200143, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [87792.05192875587, -43909.95562643821, -116819.7219188227, -42060.82421159076], "total": -114998.4498280958, "cumulative": 80001.40060390563, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [35302.299649207875, -83365.94092999503, -136643.25896078488, -136604.09762992107], "total": -321310.9978714931, "cumulative": -241309.5972675875, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-PH10', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-PH10', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        
        <div class="entity-section" id="TH10">
            <div class="entity-header">
                <h2><span class="entity-badge">TH10</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>RandomForest</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$8.03M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$9.42M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$-1.39M</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$-140.2K</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-TH10" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$56.4K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$80.1K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">112.5%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">0.0%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-TH10" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on RandomForest model.</p>
                    <div id="short-forecast-TH10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">‚ö†Ô∏è At Risk</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Expected net outflow of $140.2K over the next month. Monitor closely.</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-TH10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">Needs Attention</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $-868.1K. Consider strategic adjustments.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$57.9K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$57.9K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-12.4K</span><span class="week-val" style="color: #ef4444">$-80.9K</span><span class="week-val" style="color: #22c55e">$11.4K</span><span class="week-val" style="color: #22c55e">$139.9K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-16.2K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$41.7K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-97.3K</span><span class="week-val" style="color: #ef4444">$-90.8K</span><span class="week-val" style="color: #22c55e">$119.6K</span><span class="week-val" style="color: #22c55e">$52.3K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-356.4K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-314.7K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-99.9K</span><span class="week-val" style="color: #ef4444">$-9.3K</span><span class="week-val" style="color: #ef4444">$-129.2K</span><span class="week-val" style="color: #ef4444">$-118.0K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-768.2K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-1.08M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-12.7K</span><span class="week-val" style="color: #ef4444">$-213.1K</span><span class="week-val" style="color: #ef4444">$-206.5K</span><span class="week-val" style="color: #ef4444">$-335.9K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-111.5K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-1.19M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$309.5K</span><span class="week-val" style="color: #ef4444">$-111.5K</span><span class="week-val" style="color: #ef4444">$-143.0K</span><span class="week-val" style="color: #ef4444">$-166.5K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$326.3K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-868.1K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$232.9K</span><span class="week-val" style="color: #ef4444">$-134.5K</span><span class="week-val" style="color: #22c55e">$406.1K</span><span class="week-val" style="color: #ef4444">$-178.3K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-TH10" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">AR</span><span class="cat-value">$7.85M</span></li><li><span class="cat-name">Netting AR</span><span class="cat-value">$156.2K</span></li><li><span class="cat-name">Other receipt</span><span class="cat-value">$8.9K</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Bank charges</span><span class="cat-value">-$480</span></li><li><span class="cat-name">Custom and Duty</span><span class="cat-value">-$758.2K</span></li><li><span class="cat-name">Tax payable</span><span class="cat-value">-$896.9K</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="best-model">
                            <td>RandomForest ‚≠ê</td>
                            <td>$56.4K</td>
                            <td>$80.1K</td>
                            <td>112.5</td>
                            <td>0.0</td>
                        </tr><tr class="">
                            <td>GradientBoosting </td>
                            <td>$84.7K</td>
                            <td>$116.9K</td>
                            <td>220.3</td>
                            <td>0.0</td>
                        </tr><tr class="">
                            <td>Ridge </td>
                            <td>$244.8K</td>
                            <td>$291.3K</td>
                            <td>1188.2</td>
                            <td>33.3</td>
                        </tr><tr class="">
                            <td>Ensemble </td>
                            <td>$88.7K</td>
                            <td>$103.4K</td>
                            <td>290.4</td>
                            <td>0.0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-TH10', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-38832.36741, -45176.7165, -59831.788199999886, -13533.2281],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-102540.71071082717, -59661.247266756895, 86361.99726578934, -12234.118613051436],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-TH10', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [4.40586, 5.497170000000001, 19.68648, 598704.23006, 8.18266, 3.43734, 0.0, 0.0, 727597.28389, 4.68537, 0.0, 564.59, 830205.7525, 11.65885, 798885.19416, 0.0, 545057.63, 22.41518, 3.97266, 276.04179999999997, 0.0, 624983.3067, 10885.75798, 2862.84, 2.2653, 157889.49742, 767100.77205, 8.57489, 244.99348, 1164521.54, 15.75705, 27.752290000000002, 259.96788999999995, 2605.55324, 33479.24786, 5.50124, 1.01181, 0.63993, 1122076.18049, 27.35411, 61.52055, 1.10768, 638436.4855400001, 69.45984],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-21959.62238, -92683.20526999999, -44303.492029999994, -516833.96777, -36876.094, -80218.42852, -61332.959969999996, -361813.81239, -93637.14267999999, -82386.0092, -73335.46155, -47743.54057, -572415.6248799999, -109975.86782000001, -58719.34962, -78515.22289, -1546129.19162, -16030.85709, -120920.99702999998, -31399.05561, -1539050.22323, -33145.16659, -73403.79244, -212168.14779000002, -105439.98702, -90178.66940000001, -63395.62054999999, -78715.30722999999, -80386.74575999999, -732599.6025300001, -61709.405549999996, -138725.2125, -37808.20863, -207026.81259999998, -95780.38554, -237736.13752, -79371.56778000001, -47939.24654, -599654.42063, -64008.89918, -38893.88796, -45177.824179999996, -698268.27374, -13602.687940000002],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-21955.21652, -92677.70809999999, -44283.80555, 81870.26228999998, -36867.91134, -80214.99117999998, -61332.959969999996, -361813.81239, 633960.14121, -82381.32383000001, -73335.46155, -47178.95057, 257790.12761999996, -109964.20897, 740165.8445399998, -78515.22289, -1001071.5616199997, -16008.44191, -120917.02437, -31123.01381, -1539050.22323, 591838.1401099999, -62518.03446, -209305.30779000002, -105437.72172, 67710.82802, 703705.1515, -78706.73233999999, -80141.75227999999, 431921.9374699999, -61693.6485, -138697.46021, -37548.24074, -204421.25935999997, -62301.13768, -237730.63627999998, -79370.55597, -47938.60661, 522421.75986, -63981.54506999999, -38832.36741, -45176.7165, -59831.788199999886, -13533.2281],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = -13533.2281;
        Plotly.newPlot('short-forecast-TH10', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-79370.55597, -47938.60661, 522421.75986, -63981.54506999999, -38832.36741, -45176.7165, -59831.788199999886, -13533.2281],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([-85547.33964083393, -95252.43912190793, -149908.86304273226, 190530.01132091857]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-37548.24074, -204421.25935999997, -62301.13768, -237730.63627999998, -79370.55597, -47938.60661, 522421.75986, -63981.54506999999, -38832.36741, -45176.7165, -59831.788199999886, -13533.2281],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [-12396.585393326895, -80915.60938144606, 11350.436298240675, 139900.94580615507], "total": 57939.187329622786, "cumulative": 57939.187329622786, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [-97293.30278927549, -90798.08415035698, 119620.10506251227, 52280.80363955507], "total": -16190.478237565127, "cumulative": 41748.70909205766, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [-99928.9736543711, -9256.538290440112, -129213.84831867073, -118005.06674040762], "total": -356404.4270038896, "cumulative": -314655.7179118319, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [-12703.160169798433, -213107.80737376944, -206526.59743426752, -335854.612563888], "total": -768192.1775417234, "cumulative": -1082847.8954535553, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [309476.423085128, -111528.80528783283, -143025.65809384192, -166469.97463505188], "total": -111548.01493159862, "cumulative": -1194395.910385154, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [232943.68729715026, -134492.459594557, 406090.33591095766, -178251.4462589818], "total": 326290.11735456914, "cumulative": -868105.7930305848, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-TH10', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-TH10', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        
        <div class="entity-section" id="ID10">
            <div class="entity-header">
                <h2><span class="entity-badge">ID10</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>Ensemble</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$10.79M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$10.56M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$220.4K</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$-285.9K</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-ID10" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$189.7K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$198.0K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">549.5%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">66.7%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-ID10" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on Ensemble model.</p>
                    <div id="short-forecast-ID10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">‚ö†Ô∏è At Risk</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Expected net outflow of $285.9K over the next month. Monitor closely.</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-ID10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">Needs Attention</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $-138.9K. Consider strategic adjustments.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$195.5K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$195.5K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-43.1K</span><span class="week-val" style="color: #ef4444">$-61.0K</span><span class="week-val" style="color: #22c55e">$59.4K</span><span class="week-val" style="color: #22c55e">$240.2K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$41.7K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$237.2K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-90.6K</span><span class="week-val" style="color: #ef4444">$-49.2K</span><span class="week-val" style="color: #22c55e">$109.0K</span><span class="week-val" style="color: #22c55e">$72.5K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$421.9K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$659.0K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-74.8K</span><span class="week-val" style="color: #22c55e">$188.5K</span><span class="week-val" style="color: #22c55e">$165.4K</span><span class="week-val" style="color: #22c55e">$142.8K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$17.7K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$676.8K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$227.7K</span><span class="week-val" style="color: #ef4444">$-84.6K</span><span class="week-val" style="color: #22c55e">$23.8K</span><span class="week-val" style="color: #ef4444">$-149.2K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-210.1K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$466.7K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$142.6K</span><span class="week-val" style="color: #ef4444">$-140.8K</span><span class="week-val" style="color: #ef4444">$-111.1K</span><span class="week-val" style="color: #ef4444">$-100.8K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-605.5K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-138.9K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-226.4K</span><span class="week-val" style="color: #ef4444">$-79.7K</span><span class="week-val" style="color: #ef4444">$-154.1K</span><span class="week-val" style="color: #ef4444">$-145.3K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-ID10" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">AR</span><span class="cat-value">$7.13M</span></li><li><span class="cat-name">Loan receipt</span><span class="cat-value">$2.36M</span></li><li><span class="cat-name">Netting AR</span><span class="cat-value">$413.6K</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Interest income</span><span class="cat-value">-$1</span></li><li><span class="cat-name">Bank charges</span><span class="cat-value">-$5.9K</span></li><li><span class="cat-name">Tax payable</span><span class="cat-value">-$137.1K</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td>RandomForest </td>
                            <td>$231.0K</td>
                            <td>$273.9K</td>
                            <td>252.4</td>
                            <td>33.3</td>
                        </tr><tr class="">
                            <td>GradientBoosting </td>
                            <td>$210.6K</td>
                            <td>$268.3K</td>
                            <td>289.8</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>Ridge </td>
                            <td>$184.0K</td>
                            <td>$201.1K</td>
                            <td>975.4</td>
                            <td>66.7</td>
                        </tr><tr class="best-model">
                            <td>Ensemble ‚≠ê</td>
                            <td>$189.7K</td>
                            <td>$198.0K</td>
                            <td>549.5</td>
                            <td>66.7</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-ID10', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-51693.447179999996, -6168.28617000001, -309062.31998, 576340.69672],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [126254.83257110267, 101178.22915863272, -99855.76651300272, 312049.6891496136],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-ID10', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [1.27965, 2.42242, 107716.15766000001, 68295.82752, 466609.00898, 1.31397, 150148.1, 233357.56, 516995.84667999996, 24.3952, 132114.6615, 234841.89884, 99575.65675, 490450.38, 105272.95777, 248826.52596, 310282.32314, 325604.75852000003, 483.93021000000005, 112912.24556000001, 247415.6149, 819963.8353500001, 206751.1238, 15.76302, 248061.91775999998, 832381.2899999999, 57588.446840000004, 65.06591, 187103.01901000002, 220585.02071, 524961.53069, 29.48537, 134975.58451, 462151.24073, 558613.36974, 34.58991999999999, 96424.57346999999, 344030.40018, 564755.21716, 11024.635129999999, 53.58749, 111238.13157, 459407.59706, 1094112.45],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-57653.639599999995, -57824.78521, -113587.47244000001, -426969.3094100001, -87626.14769, -85753.11262, -61279.04136, -470201.02888999996, -229904.80472000001, -46506.08982, -102110.57330999999, -158131.71765000004, -456225.8181000001, -297919.02164999995, -59054.433419999994, -95182.64334, -357342.13438999996, -216051.91887, -97861.9175, -39802.513609999995, -486579.84717, -704802.4997100001, -49952.26464000001, -81092.21755, -127385.09881000001, -769134.25065, -253666.68374999997, -59166.10278, -101201.01705999998, -407073.93692000007, -232288.55675000002, -67461.33946, -51341.13134, -666156.9740500001, -448787.22639, -54936.697060000006, -100148.92185000001, -143641.75244999997, -408563.39985, -379131.1494, -51747.034669999994, -117406.41774, -768469.9170400001, -517771.75328],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-57652.35995, -57822.36279000001, -5871.314779999998, -358673.4818900001, 378982.86129, -85751.79865000001, 88869.05863999994, -236843.46889, 287091.04196, -46481.694619999995, 30004.08819000001, 76710.18118999999, -356650.16134999995, 192531.35834999997, 46218.52434999997, 153643.88262000002, -47059.81125, 109552.83964999998, -97377.98728999999, 73109.73195000003, -239164.23227000004, 115161.33563999996, 156798.85916000002, -81076.45453000002, 120676.81895000004, 63247.03934999997, -196078.23690999998, -59101.036869999996, 85902.00195000003, -186488.91621, 292672.97394, -67431.85409000001, 83634.45316999998, -204005.7333199999, 109826.14335, -54902.10714000001, -3724.348380000003, 200388.64773000003, 156191.81731000004, -368106.51427000004, -51693.447179999996, -6168.28617000001, -309062.31998, 576340.69672],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = 576340.69672;
        Plotly.newPlot('short-forecast-ID10', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-3724.348380000003, 200388.64773000003, 156191.81731000004, -368106.51427000004, -51693.447179999996, -6168.28617000001, -309062.31998, 576340.69672],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([-327558.95797345473, -160491.2080647937, -8224.524199369123, 210385.70504899218]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [83634.45316999998, -204005.7333199999, 109826.14335, -54902.10714000001, -3724.348380000003, 200388.64773000003, 156191.81731000004, -368106.51427000004, -51693.447179999996, -6168.28617000001, -309062.31998, 576340.69672],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [-43118.36140749388, -61049.0385413169, 59407.70748454454, 240223.10632307205], "total": 195463.4138588058, "cumulative": 195463.4138588058, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [-90634.24726516147, -49178.59118326533, 108980.10935940579, 72536.17088432204], "total": 41703.44179530103, "cumulative": 237166.85565410682, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [-74759.14185911123, 188483.0560816691, 165350.19483392834, 142792.81189811864], "total": 421866.92095460487, "cumulative": 659033.7766087117, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [227745.8105967912, -84607.17668607936, 23782.70058502625, -149192.55066089684], "total": 17728.783834841262, "cumulative": 676762.5604435529, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [142608.4600593521, -140798.58238645346, -111127.20775231274, -100790.59424914158], "total": -210107.92432855567, "cumulative": 466654.6361149972, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [-226373.12313217827, -79744.45247402487, -154083.21274866603, -145337.1349629833], "total": -605537.9233178524, "cumulative": -138883.28720285522, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-ID10', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-ID10', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        
        <div class="entity-section" id="SS10">
            <div class="entity-header">
                <h2><span class="entity-badge">SS10</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>Ridge</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$1.61M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$1.36M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$254.6K</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$188.9K</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-SS10" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$17.7K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$20.1K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">1233.6%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">66.7%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-SS10" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on Ridge model.</p>
                    <div id="short-forecast-SS10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #C4D600">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #C4D600">‚úÖ Stable</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Healthy cash position expected. Net inflow forecast: $188.9K</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-SS10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">Needs Attention</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $-93.5K. Consider strategic adjustments.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$102.2K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$102.2K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$27.5K</span><span class="week-val" style="color: #22c55e">$1.1K</span><span class="week-val" style="color: #22c55e">$29.6K</span><span class="week-val" style="color: #22c55e">$43.9K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$100.0K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$202.2K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$5.4K</span><span class="week-val" style="color: #22c55e">$6.3K</span><span class="week-val" style="color: #22c55e">$67.5K</span><span class="week-val" style="color: #22c55e">$20.9K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-22.3K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$179.8K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-22.3K</span><span class="week-val" style="color: #22c55e">$20.7K</span><span class="week-val" style="color: #ef4444">$-5.3K</span><span class="week-val" style="color: #ef4444">$-15.4K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-92.0K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$87.8K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-12.9K</span><span class="week-val" style="color: #ef4444">$-23.7K</span><span class="week-val" style="color: #ef4444">$-22.3K</span><span class="week-val" style="color: #ef4444">$-33.1K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-144.3K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-56.4K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-25.2K</span><span class="week-val" style="color: #22c55e">$16.3K</span><span class="week-val" style="color: #ef4444">$-6.2K</span><span class="week-val" style="color: #ef4444">$-129.2K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-37.1K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-93.5K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-61.9K</span><span class="week-val" style="color: #22c55e">$3.5K</span><span class="week-val" style="color: #22c55e">$43.9K</span><span class="week-val" style="color: #ef4444">$-22.6K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-SS10" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Netting AR</span><span class="cat-value">$1.18M</span></li><li><span class="cat-name">Nonting AR</span><span class="cat-value">$232.8K</span></li><li><span class="cat-name">Other receipt</span><span class="cat-value">$202.0K</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Bank charges</span><span class="cat-value">-$157</span></li><li><span class="cat-name">Netting AP</span><span class="cat-value">-$6.0K</span></li><li><span class="cat-name">AP</span><span class="cat-value">-$321.4K</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td>RandomForest </td>
                            <td>$34.4K</td>
                            <td>$45.1K</td>
                            <td>919.7</td>
                            <td>0.0</td>
                        </tr><tr class="">
                            <td>GradientBoosting </td>
                            <td>$61.7K</td>
                            <td>$78.6K</td>
                            <td>2521.4</td>
                            <td>0.0</td>
                        </tr><tr class="best-model">
                            <td>Ridge ‚≠ê</td>
                            <td>$17.7K</td>
                            <td>$20.1K</td>
                            <td>1233.6</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>Ensemble </td>
                            <td>$20.6K</td>
                            <td>$24.5K</td>
                            <td>252.2</td>
                            <td>66.7</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-SS10', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-8816.00367, 6757.5143400000015, -62652.16125999999, -598.9863500000001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [18422.59098742506, -4771.407152404576, -67969.63138089825, -27231.29234800337],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-SS10', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [4.8552, 213.26632999999998, 45473.05919, 217044.8246, 4208.6320000000005, 2.04659, 9.12421, 16.458, 20204.410000000003, 43361.52, 10365.15, 764.1764800000001, 7690.19912, 50.58441, 85318.38, 20.58668, 50.89533, 187.92, 0.0, 84855.23035, 525145.27886, 41408.868899999994, 2918.93336, 2044.65555, 50888.841420000004, 12486.539560000001, 30.81406, 63.77663, 32.5234, 6175.55512, 619.95184, 13106.59612, 0.0, 365073.93, 18353.44, 386.72884, 1001.4000000000001, 27039.010000000002, 13525.81752, 215.41843999999998, 413.98624, 12380.44, 0.0, 11.26073],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-803.08599, -20887.64107, -1400.39377, -58356.424150000006, -28524.333809999996, -8672.95264, -7941.58863, -58582.763139999995, -13017.41814, -28050.65885, -7959.332259999999, -189040.81826, -111389.30084, -9193.620949999997, -10640.538840000001, -6842.430240000001, -60037.88492, -31033.85116, -11240.26086, -6240.628159999999, -69157.28921, -37584.34176, -7578.23821, -4452.54106, -61223.73414, -3281.37974, -30180.737510000003, -12730.41146, -5255.291139999999, -83675.04225, -36233.42083, -9421.82697, -8241.26578, -52383.668789999996, -25935.72625, -42285.02726, -10795.438719999998, -1520.5685299999998, -79836.98124000001, -28817.128699999997, -9229.98991, -5622.925659999999, -62652.16125999999, -610.2470800000001],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-798.23079, -20674.374740000003, 44072.66542, 158688.40044999996, -24315.701809999995, -8670.90605, -7932.46442, -58566.30514, 7186.99186, 15310.861149999993, 2405.8177400000004, -188276.64178, -103699.10172, -9143.036540000001, 74677.84116000001, -6821.84356, -59986.98959, -30845.93116, -11240.26086, 78614.60218999999, 455987.98965, 3824.52714, -4659.3048499999995, -2407.88551, -10334.89272, 9205.15982, -30149.923450000002, -12666.634829999999, -5222.767739999999, -77499.48713000001, -35613.46899, 3684.76915, -8241.26578, 312690.26120999997, -7582.286250000001, -41898.29842, -9794.03872, 25518.441469999998, -66311.16372000001, -28601.710259999996, -8816.00367, 6757.5143400000015, -62652.16125999999, -598.9863500000001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = -598.9863500000001;
        Plotly.newPlot('short-forecast-SS10', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-9794.03872, 25518.441469999998, -66311.16372000001, -28601.710259999996, -8816.00367, 6757.5143400000015, -62652.16125999999, -598.9863500000001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([-3587.0371084446, 6336.627659597159, 191679.9241727251, -5495.842779383409]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-8241.26578, 312690.26120999997, -7582.286250000001, -41898.29842, -9794.03872, 25518.441469999998, -66311.16372000001, -28601.710259999996, -8816.00367, 6757.5143400000015, -62652.16125999999, -598.9863500000001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [27546.310079376333, 1108.3709561441192, 29585.374985199007, 43913.32152335749], "total": 102153.37754407694, "cumulative": 102153.37754407694, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [5412.364357981824, 6271.337277489223, 67501.04243154843, 20853.920634846123], "total": 100038.66470186561, "cumulative": 202192.04224594255, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [-22311.510621639023, 20653.903989627248, -5269.306609371268, -15416.278452057872], "total": -22343.191693440916, "cumulative": 179848.85055250162, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [-12913.63520941588, -23705.8813057299, -22315.220892893256, -33065.29894905256], "total": -92000.0363570916, "cumulative": 87848.81419541003, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [-25200.052853634268, 16321.769996213225, -6202.629704857258, -129176.68038948673], "total": -144257.59295176502, "cumulative": -56408.778756354994, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [-61921.23225736109, 3499.865139540017, 43906.11776253559, -22580.620378038533], "total": -37095.86973332401, "cumulative": -93504.648489679, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-SS10', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-SS10', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        
        <div class="entity-section" id="MY10">
            <div class="entity-header">
                <h2><span class="entity-badge">MY10</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>GradientBoosting</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$8.12M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$9.70M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$-1.58M</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$-1.09M</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-MY10" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$113.5K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$159.1K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">16.8%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-MY10" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on GradientBoosting model.</p>
                    <div id="short-forecast-MY10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">‚ö†Ô∏è At Risk</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Expected net outflow of $1.09M over the next month. Monitor closely.</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-MY10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">Needs Attention</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $-4.08M. Consider strategic adjustments.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-378.4K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-378.4K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-61.1K</span><span class="week-val" style="color: #ef4444">$-183.6K</span><span class="week-val" style="color: #ef4444">$-98.2K</span><span class="week-val" style="color: #ef4444">$-35.5K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-631.5K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-1.01M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-236.5K</span><span class="week-val" style="color: #ef4444">$-154.1K</span><span class="week-val" style="color: #ef4444">$-77.6K</span><span class="week-val" style="color: #ef4444">$-163.3K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-791.6K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-1.80M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-204.1K</span><span class="week-val" style="color: #ef4444">$-94.0K</span><span class="week-val" style="color: #ef4444">$-266.9K</span><span class="week-val" style="color: #ef4444">$-226.5K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-1.19M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-2.99M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-159.1K</span><span class="week-val" style="color: #ef4444">$-289.7K</span><span class="week-val" style="color: #ef4444">$-208.5K</span><span class="week-val" style="color: #ef4444">$-528.6K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-475.0K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-3.46M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$214.8K</span><span class="week-val" style="color: #ef4444">$-159.6K</span><span class="week-val" style="color: #ef4444">$-242.2K</span><span class="week-val" style="color: #ef4444">$-288.0K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-615.4K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-4.08M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$2.4K</span><span class="week-val" style="color: #ef4444">$-193.2K</span><span class="week-val" style="color: #ef4444">$-134.8K</span><span class="week-val" style="color: #ef4444">$-289.7K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-MY10" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">AR</span><span class="cat-value">$8.06M</span></li><li><span class="cat-name">Nonting AR</span><span class="cat-value">$45.5K</span></li><li><span class="cat-name">Other receipt</span><span class="cat-value">$19.4K</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Bank charges</span><span class="cat-value">-$129</span></li><li><span class="cat-name">Interest charges</span><span class="cat-value">-$15.2K</span></li><li><span class="cat-name">Nonting AP</span><span class="cat-value">-$93.8K</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td>RandomForest </td>
                            <td>$194.1K</td>
                            <td>$267.4K</td>
                            <td>37.5</td>
                            <td>100.0</td>
                        </tr><tr class="best-model">
                            <td>GradientBoosting ‚≠ê</td>
                            <td>$113.5K</td>
                            <td>$159.1K</td>
                            <td>16.8</td>
                            <td>100.0</td>
                        </tr><tr class="">
                            <td>Ridge </td>
                            <td>$192.2K</td>
                            <td>$270.8K</td>
                            <td>80.3</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>Ensemble </td>
                            <td>$156.7K</td>
                            <td>$214.7K</td>
                            <td>39.5</td>
                            <td>66.7</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-MY10', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-47854.232050000006, -21735.80982, -925379.0575799999, 809093.7142800001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-46074.448192071846, -24207.393526513133, -702253.5096241578, 582280.1048127515],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-MY10', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [245.20666, 22924.744749999998, 14348.631519999999, 875678.049, 1.04574, 9.78402, 6837.900000000001, 14683.9886, 699443.2100000001, 89.31884, 0.0, 10.57124, 782450.6900000001, 8.2296, 252.41270999999998, 1245.25052, 773324.9990899999, 1.161, 0.0946, 0.0, 57383.47, 745433.32033, 0.1078, 347.95241, 335.47, 1145396.49, 274.24715000000003, 915.2698899999999, 152.47415, 640289.24671, 0.0, 130.67915, 40.03576, 442.79457, 786737.85567, 7414.501, 88.83619999999999, 0.0, 655229.64475, 0.0, 36.43704, 0.0, 74904.34516, 814086.53215],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-24161.28726, -23684.57824, -30928.204859999998, -812539.98982, -73953.74041, -46970.668739999994, -19883.61912, -598205.37775, -20193.15355, -50243.79971000001, -33347.44576, -131483.94165, -680306.0561500001, -30468.74181, -46904.781480000005, -23131.91932, -1577013.3373800002, -99879.97738000001, -55161.90507, -21053.289569999997, -706913.6567, -60341.2696, -50978.92374, -39909.73726, -87528.47862999998, -931718.52955, -40943.439419999995, -74409.16631999999, -15164.295849999999, -1104611.15244, -71193.7947, -50384.18674999999, -32496.118150000002, -188304.91415000003, -65389.203859999994, -96542.37276, -42322.63336, -25314.80467, -454608.87460999994, -87500.1422, -47890.66909, -21735.80982, -1000283.4027399999, -4992.81787],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-23916.0806, -759.8334900000009, -16579.573339999995, 63138.0591800001, -73952.69467, -46960.88472, -13045.71912, -583521.3891500001, 679250.05645, -50154.48087, -33347.44576, -131473.37041, 102144.6338500001, -30460.51221, -46652.36876999999, -21886.6688, -803688.3382900002, -99878.81638, -55161.81047, -21053.289569999997, -649530.1867, 685092.05073, -50978.81594, -39561.78485, -87193.00862999998, 213677.96045, -40669.19227, -73493.89643, -15011.821699999999, -464321.9057299999, -71193.7947, -50253.5076, -32456.082390000003, -187862.11958, 721348.65181, -89127.87176000001, -42233.79716, -25314.80467, 200620.77013999998, -87500.1422, -47854.232050000006, -21735.80982, -925379.0575799999, 809093.7142800001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = 809093.7142800001;
        Plotly.newPlot('short-forecast-MY10', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-42233.79716, -25314.80467, 200620.77013999998, -87500.1422, -47854.232050000006, -21735.80982, -925379.0575799999, 809093.7142800001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([-231466.06361662655, -289834.17102276784, -574468.6675935448, 6892.610616644059]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-32456.082390000003, -187862.11958, 721348.65181, -89127.87176000001, -42233.79716, -25314.80467, 200620.77013999998, -87500.1422, -47854.232050000006, -21735.80982, -925379.0575799999, 809093.7142800001],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [-61076.00998458725, -183610.0798757469, -98230.73702053593, -35489.781754179654], "total": -378406.60863504966, "cumulative": -378406.60863504966, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [-236475.28737362305, -154123.62703932554, -77618.30238434, -163295.31973827997], "total": -631512.5365355685, "cumulative": -1009919.1451706182, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [-204116.78087404766, -94043.91323220033, -266859.5603235955, -226543.08397881806], "total": -791563.3384086615, "cumulative": -1801482.4835792799, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [-159087.03695749267, -289669.15582897223, -208533.27473509108, -528646.6007713507], "total": -1185936.0682929067, "cumulative": -2987418.5518721864, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [214773.67378846783, -159588.77520389907, -242215.02233082074, -288017.6574088864], "total": -475047.7811551384, "cumulative": -3462466.3330273246, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [2370.3578376153746, -193205.7415177018, -134795.83841712607, -289730.0614568024], "total": -615361.2835540149, "cumulative": -4077827.6165813394, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-MY10', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-MY10', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        
        <div class="entity-section" id="VN20">
            <div class="entity-header">
                <h2><span class="entity-badge">VN20</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>Ensemble</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$17.06M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$17.46M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$-394.8K</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$-1.82M</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-VN20" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$163.5K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$185.3K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">2539.7%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">100.0%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-VN20" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on Ensemble model.</p>
                    <div id="short-forecast-VN20" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">‚ö†Ô∏è At Risk</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Expected net outflow of $1.82M over the next month. Monitor closely.</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-VN20" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #D0006F">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #D0006F">Needs Attention</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $-9.08M. Consider strategic adjustments.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-393.7K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-393.7K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$84.5K</span><span class="week-val" style="color: #ef4444">$-226.1K</span><span class="week-val" style="color: #ef4444">$-239.8K</span><span class="week-val" style="color: #ef4444">$-12.4K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-432.5K</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-826.2K</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-135.0K</span><span class="week-val" style="color: #ef4444">$-221.5K</span><span class="week-val" style="color: #22c55e">$72.9K</span><span class="week-val" style="color: #ef4444">$-148.9K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-2.41M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-3.23M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-350.2K</span><span class="week-val" style="color: #ef4444">$-598.5K</span><span class="week-val" style="color: #ef4444">$-673.0K</span><span class="week-val" style="color: #ef4444">$-784.2K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-2.72M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-5.95M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-1.00M</span><span class="week-val" style="color: #ef4444">$-437.0K</span><span class="week-val" style="color: #ef4444">$-240.5K</span><span class="week-val" style="color: #ef4444">$-1.04M</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-1.93M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-7.89M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-770.8K</span><span class="week-val" style="color: #ef4444">$-271.1K</span><span class="week-val" style="color: #ef4444">$-247.7K</span><span class="week-val" style="color: #ef4444">$-644.5K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$-1.19M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$-9.08M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #ef4444">$-585.4K</span><span class="week-val" style="color: #ef4444">$-39.3K</span><span class="week-val" style="color: #ef4444">$-81.6K</span><span class="week-val" style="color: #ef4444">$-485.1K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-VN20" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">AR</span><span class="cat-value">$10.87M</span></li><li><span class="cat-name">Loan receipt</span><span class="cat-value">$3.43M</span></li><li><span class="cat-name">Netting AR</span><span class="cat-value">$2.74M</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Interest charges</span><span class="cat-value">-$8</span></li><li><span class="cat-name">Bank charges</span><span class="cat-value">-$773</span></li><li><span class="cat-name">Payroll</span><span class="cat-value">-$1.43M</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td>RandomForest </td>
                            <td>$175.2K</td>
                            <td>$220.2K</td>
                            <td>770.4</td>
                            <td>100.0</td>
                        </tr><tr class="">
                            <td>GradientBoosting </td>
                            <td>$174.3K</td>
                            <td>$190.6K</td>
                            <td>3018.2</td>
                            <td>100.0</td>
                        </tr><tr class="">
                            <td>Ridge </td>
                            <td>$177.1K</td>
                            <td>$226.6K</td>
                            <td>3829.5</td>
                            <td>100.0</td>
                        </tr><tr class="best-model">
                            <td>Ensemble ‚≠ê</td>
                            <td>$163.5K</td>
                            <td>$185.3K</td>
                            <td>2539.7</td>
                            <td>100.0</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-VN20', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [346871.09432999993, 18350.57692999998, -845517.9321999999, 2247.29514],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [327104.28634430864, -158692.99501582008, -593983.6073977514, -203570.4723940947],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-VN20', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [887.0003800000001, 367319.72578, 409521.75642, 14.82888, 1100268.16088, 215922.54551, 528256.6034199999, 265249.14741000003, 1660598.0777599998, 1220.17494, 243253.69177, 225108.25266, 2086286.95033, 351450.16779, 290334.12318999995, 122065.46514, 542149.41432, 248748.61, 323678.20514, 314953.4706, 131055.4905, 446963.59690999996, 310333.30445, 374828.23397, 79092.99733, 535666.82747, 218900.11394, 562348.10888, 303742.75114, 382936.75048000005, 431784.49, 336037.02918, 300162.05757, 84925.89104000002, 232996.70103, 388136.98604, 797453.9390199999, 220059.51403999998, 359632.82428, 366725.57999999996, 383510.93534, 206825.64858, 297904.47621, 11550.8],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-34793.491270000006, -224379.24274, -97698.84743, -16835.443450000002, -2093873.56221, -28780.25714, -34337.305499999995, -1199436.38936, -1795771.8346, -27262.87888, -48251.80859000001, -345131.55448, -2401506.61828, -28660.578510000003, -50647.18518, -259071.89798000007, -1107407.95861, -51707.11148, -30108.02312, -47945.446099999994, -197910.67406000002, -573187.2826899999, -45334.03726, -55192.416249999995, -185739.70324000003, -1431328.3954099999, -45007.93290999999, -25335.128920000003, -207962.82937999998, -1120563.27637, -36318.255020000004, -72009.07918, -35507.9176, -924124.372, -29275.55477, -30121.738339999993, -52730.220239999995, -198810.13889999996, -841631.48794, -46103.45869, -36639.84101, -188475.07165, -1143422.40841, -9303.50486],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-33906.490889999994, 142940.48303999996, 311822.90898999997, -16820.61457, -993605.4013300003, 187142.28837000002, 493919.29792000004, -934187.24195, -135173.7568399998, -26042.70394, 195001.88318, -120023.30181999998, -315219.66795000026, 322789.58928, 239686.93800999998, -137006.43283999996, -565258.5442900001, 197041.49852, 293570.18202, 267008.0245, -66855.18356, -126223.68577999996, 264999.2671899999, 319635.81772, -106646.70591000003, -895661.5679399999, 173892.18103, 537012.9799599999, 95779.92176000003, -737626.5258899999, 395466.23498, 264027.95, 264654.13997, -839198.4809600001, 203721.14626, 358015.2477, 744723.7187799999, 21249.37513999999, -481998.66365999996, 320622.12130999996, 346871.09432999993, 18350.57692999998, -845517.9321999999, 2247.29514],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = 2247.29514;
        Plotly.newPlot('short-forecast-VN20', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [744723.7187799999, 21249.37513999999, -481998.66365999996, 320622.12130999996, 346871.09432999993, 18350.57692999998, -845517.9321999999, 2247.29514],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([241745.0026657949, 915739.6799614489, -1393896.4426976182, -1582216.6108006714]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [264654.13997, -839198.4809600001, 203721.14626, 358015.2477, 744723.7187799999, 21249.37513999999, -481998.66365999996, 320622.12130999996, 346871.09432999993, 18350.57692999998, -845517.9321999999, 2247.29514],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [84460.49532036019, -226057.727440725, -239765.8975479075, -12359.462633216695], "total": -393722.59230148897, "cumulative": -393722.59230148897, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [-135006.3871907262, -221466.97509249434, 72861.96094703829, -148883.13318993186], "total": -432494.5345261141, "cumulative": -826217.1268276031, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [-350205.9038007943, -598489.2530911698, -673022.3921223249, -784202.152917751], "total": -2405919.70193204, "cumulative": -3232136.8287596432, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [-1001587.2452974177, -436996.3646553281, -240503.50542744255, -1041346.3036768534], "total": -2720433.419057042, "cumulative": -5952570.247816686, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [-770770.3657383265, -271057.941539937, -247691.28231388613, -644508.0236542508], "total": -1934027.6132464004, "cumulative": -7886597.8610630855, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [-585399.965773721, -39307.660522936334, -81647.62182781503, -485110.08969057346], "total": -1191465.3378150458, "cumulative": -9078063.198878132, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-VN20', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-VN20', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        
        <div class="entity-section" id="KR10">
            <div class="entity-header">
                <h2><span class="entity-badge">KR10</span> Cash Flow Analysis</h2>
                <div class="model-badge">Best Model: <strong>Ensemble</strong></div>
            </div>

            <!-- KPI Cards Row -->
            <div class="kpi-row">
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value" style="color: #C4D600">$45.71M</div>
                    <div class="kpi-label">Total Inflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∏</div>
                    <div class="kpi-value" style="color: #D0006F">$47.25M</div>
                    <div class="kpi-label">Total Outflow</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìä</div>
                    <div class="kpi-value" style="color: #003865">$-1.54M</div>
                    <div class="kpi-label">Net Position</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value" style="color: #68D2DF">$5.89M</div>
                    <div class="kpi-label">1-Month Forecast</div>
                </div>
            </div>

            <!-- Main Charts Section -->
            <div class="charts-grid">
                <!-- Backtest Chart -->
                <div class="chart-container full-width">
                    <h3>üîç Backtest: Actual vs Forecast (Last 4 Weeks)</h3>
                    <p class="chart-description">Comparing model predictions against actual cash flows to evaluate forecast accuracy.</p>
                    <div id="backtest-KR10" class="chart"></div>
                    <div class="metrics-row">
                        <div class="metric">
                            <span class="metric-label">MAE</span>
                            <span class="metric-value">$640.8K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">RMSE</span>
                            <span class="metric-value">$713.0K</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">MAPE</span>
                            <span class="metric-value">1311.5%</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Direction Accuracy</span>
                            <span class="metric-value">66.7%</span>
                        </div>
                    </div>
                </div>

                <!-- Inflow/Outflow Chart -->
                <div class="chart-container full-width">
                    <h3>üíπ Cash Flow Overview: Inflow vs Outflow</h3>
                    <p class="chart-description">Weekly breakdown of cash inflows and outflows across the historical period.</p>
                    <div id="inflow-outflow-KR10" class="chart"></div>
                </div>

                <!-- Short-term Forecast -->
                <div class="chart-container">
                    <h3>üìÖ 1-Month Ahead Forecast</h3>
                    <p class="chart-description">Weekly cash flow predictions for the next 4 weeks based on Ensemble model.</p>
                    <div id="short-forecast-KR10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #C4D600">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #C4D600">‚úÖ Stable</span>
                            <strong>Short-term Liquidity Assessment</strong>
                        </div>
                        <p>Healthy cash position expected. Net inflow forecast: $5.89M</p>
                    </div>
                </div>

                <!-- Long-term Forecast -->
                <div class="chart-container">
                    <h3>üìÜ 6-Month Ahead Forecast (Iterative Month-by-Month)</h3>
                    <p class="chart-description">Each month's forecast uses previous months' predictions as input features, building iteratively.</p>
                    <div id="long-forecast-KR10" class="chart"></div>
                    <div class="insight-box" style="border-left-color: #C4D600">
                        <div class="insight-header">
                            <span class="status-badge" style="background: #C4D600">Sustainable</span>
                            <strong>Long-term Sustainability</strong>
                        </div>
                        <p>6-month forecasted total: $29.26M. Position appears sustainable.</p>
                    </div>
                </div>
            </div>

            <!-- Month-by-Month Forecast Breakdown -->
            <div class="monthly-breakdown">
                <h3>üìä Month-by-Month Forecast Breakdown</h3>
                <p class="chart-description">Iterative forecasting: each month's prediction feeds into the next month's features, creating a cascading forecast.</p>
                <div class="monthly-grid">
                    
                    <div class="monthly-card" style="border-top: 4px solid #68D2DF">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #68D2DF">Month 1</span>
                            <span class="month-dates">2025-11-05 ‚Üí 2025-11-26</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$3.85M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$3.85M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$832.2K</span><span class="week-val" style="color: #22c55e">$202.8K</span><span class="week-val" style="color: #22c55e">$761.8K</span><span class="week-val" style="color: #22c55e">$2.05M</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #C4D600">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #C4D600">Month 2</span>
                            <span class="month-dates">2025-12-03 ‚Üí 2025-12-24</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$5.42M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$9.27M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$968.1K</span><span class="week-val" style="color: #22c55e">$890.1K</span><span class="week-val" style="color: #22c55e">$1.94M</span><span class="week-val" style="color: #22c55e">$1.62M</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #F0AB00">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #F0AB00">Month 3</span>
                            <span class="month-dates">2025-12-31 ‚Üí 2026-01-21</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$6.98M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$16.24M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$810.9K</span><span class="week-val" style="color: #22c55e">$2.28M</span><span class="week-val" style="color: #22c55e">$2.07M</span><span class="week-val" style="color: #22c55e">$1.82M</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #D0006F">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #D0006F">Month 4</span>
                            <span class="month-dates">2026-01-28 ‚Üí 2026-02-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$4.11M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$20.35M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$1.99M</span><span class="week-val" style="color: #22c55e">$1.11M</span><span class="week-val" style="color: #22c55e">$1.08M</span><span class="week-val" style="color: #ef4444">$-73.5K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #3C1053">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #3C1053">Month 5</span>
                            <span class="month-dates">2026-02-25 ‚Üí 2026-03-18</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$4.22M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$24.57M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$1.78M</span><span class="week-val" style="color: #22c55e">$1.18M</span><span class="week-val" style="color: #22c55e">$814.3K</span><span class="week-val" style="color: #22c55e">$440.4K</span>
                        </div>
                    </div>
                    
                    <div class="monthly-card" style="border-top: 4px solid #830051">
                        <div class="monthly-header">
                            <span class="month-badge" style="background: #830051">Month 6</span>
                            <span class="month-dates">2026-03-25 ‚Üí 2026-04-15</span>
                        </div>
                        <div class="monthly-stats">
                            <div class="monthly-stat">
                                <span class="stat-value">$4.69M</span>
                                <span class="stat-label">Monthly Net</span>
                            </div>
                            <div class="monthly-stat">
                                <span class="stat-value">$29.26M</span>
                                <span class="stat-label">Cumulative</span>
                            </div>
                        </div>
                        <div class="weekly-detail">
                            <span class="week-val" style="color: #22c55e">$2.51M</span><span class="week-val" style="color: #22c55e">$819.8K</span><span class="week-val" style="color: #22c55e">$737.5K</span><span class="week-val" style="color: #22c55e">$623.2K</span>
                        </div>
                    </div>
                    
                </div>
                <div id="monthly-chart-KR10" class="chart" style="margin-top: 1.5rem;"></div>
            </div>

            <!-- Category Analysis -->
            <div class="category-analysis">
                <h3>üè∑Ô∏è Key Cash Flow Drivers</h3>
                <div class="category-grid">
                    <div class="category-box inflow">
                        <h4>Top Inflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">AR</span><span class="cat-value">$39.96M</span></li><li><span class="cat-name">Other receipt</span><span class="cat-value">$4.39M</span></li><li><span class="cat-name">Loan receipt</span><span class="cat-value">$1.34M</span></li>
                        </ul>
                    </div>
                    <div class="category-box outflow">
                        <h4>Top Outflow Categories</h4>
                        <ul>
                            <li><span class="cat-name">Bank charges</span><span class="cat-value">-$444</span></li><li><span class="cat-name">Interest charges</span><span class="cat-value">-$5.9K</span></li><li><span class="cat-name">Dividend payout</span><span class="cat-value">-$993.1K</span></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Model Performance Table -->
            <div class="model-comparison">
                <h3>ü§ñ Model Performance Comparison</h3>
                <table class="model-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>MAE</th>
                            <th>RMSE</th>
                            <th>MAPE (%)</th>
                            <th>Direction Acc (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td>RandomForest </td>
                            <td>$1.12M</td>
                            <td>$1.27M</td>
                            <td>1066.0</td>
                            <td>33.3</td>
                        </tr><tr class="">
                            <td>GradientBoosting </td>
                            <td>$670.8K</td>
                            <td>$860.5K</td>
                            <td>1332.1</td>
                            <td>66.7</td>
                        </tr><tr class="">
                            <td>Ridge </td>
                            <td>$672.9K</td>
                            <td>$754.5K</td>
                            <td>1468.8</td>
                            <td>66.7</td>
                        </tr><tr class="best-model">
                            <td>Ensemble ‚≠ê</td>
                            <td>$640.8K</td>
                            <td>$713.0K</td>
                            <td>1311.5</td>
                            <td>66.7</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>
        // Backtest Chart
        Plotly.newPlot('backtest-KR10', [
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-41755.33706999995, 28888.555129999935, -2508577.630210001, 3001118.01671],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Actual',
                line: {color: '#003865', width: 4},
                marker: {size: 14, symbol: 'circle'}
            },
            {
                x: ["2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [426726.7954305187, -1152817.33309923, -2034166.498712996, 2562368.8217485286],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Forecast',
                line: {color: '#F0AB00', width: 4, dash: 'dash'},
                marker: {size: 12, symbol: 'diamond'}
            }
        ], {
            height: 350,
            margin: {t: 30, b: 50, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: '2025-10-08', x1: '2025-10-29', y0: 0, y1: 0, line: {color: '#888', width: 1, dash: 'dot'}}]
        }, {responsive: true});

        // Inflow/Outflow Chart
        Plotly.newPlot('inflow-outflow-KR10', [
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [65429.58625000001, 278808.80697000003, 141050.98712, 646089.73887, 2135588.82213, 126717.18723, 92016.9109, 122888.36101, 3388653.3732700003, 38072.328349999996, 175988.00243999998, 92477.43058, 4108956.7974699996, 55473.391220000005, 249530.07501, 125663.94748999999, 3895875.0630200002, 427660.43460000004, 109337.97795, 82763.21512, 293383.39910999994, 3283462.86171, 62362.453460000004, 354251.33278, 1516275.17459, 3305530.4084300003, 194772.25982000004, 270751.9663, 159133.82198000004, 1653129.1419999998, 2126601.31793, 186347.95133, 184593.96000000002, 298024.87452, 3338858.6496300003, 52347.17868999999, 209704.21758, 1994297.6182199998, 3539546.65467, 764731.18758, 319783.2681, 274136.96657000005, 1727077.9233799998, 3241719.95113],
                type: 'bar',
                name: 'Inflow',
                marker: {color: '#C4D600'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-58251.93081, -353285.16952, -586244.92083, -483062.39776, -591894.4211, -387551.6934600001, -236018.12949999998, -2428276.9736599997, -2019084.0865299995, -170539.35764, -151965.14084, -496580.69933999993, -2404597.44746, -317717.77650000004, -473372.0644, -412664.03778, -4504203.35858, -995179.8158699999, -315469.70249000005, -328600.73991000006, -1909423.61547, -378752.71071, -66033.40948, -179957.81869, -553510.31253, -3336337.60384, -281894.3617700001, -305037.18313, -110373.38909999999, -5199711.1119099995, -1076369.2232100002, -502055.2875, -137365.76223000002, -2734688.8651599996, -1047975.5532099999, -216413.82205999998, -336746.83881000004, -811240.8795500001, -3501236.7301800004, -1770166.7777299997, -361538.60517, -245248.41144, -4235655.55359, -240601.93441999995],
                type: 'bar',
                name: 'Outflow',
                marker: {color: '#D0006F'}
            },
            {
                x: ["2025-01-01", "2025-01-08", "2025-01-15", "2025-01-22", "2025-01-29", "2025-02-05", "2025-02-12", "2025-02-19", "2025-02-26", "2025-03-05", "2025-03-12", "2025-03-19", "2025-03-26", "2025-04-02", "2025-04-09", "2025-04-16", "2025-04-23", "2025-04-30", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [7177.655440000002, -74476.36254999999, -445193.93370999995, 163027.3411099999, 1543694.40103, -260834.50623, -144001.21859999996, -2305388.61265, 1369569.2867400004, -132467.02929, 24022.86159999999, -404103.26876, 1704359.3500099997, -262244.38528, -223841.98938999997, -287000.09029, -608328.2955599998, -567519.38127, -206131.72453999997, -245837.52478999997, -1616040.21636, 2904710.151, -3670.956019999994, 174293.51409000007, 962764.8620600001, -30807.195410000044, -87122.10195, -34285.216830000034, 48760.432880000066, -3546581.9699100005, 1050232.09472, -315707.3361699999, 47228.19777, -2436663.99064, 2290883.09642, -164066.64337, -127042.62123, 1183056.73867, 38309.92448999913, -1005435.5901500001, -41755.33706999995, 28888.555129999935, -2508577.630210001, 3001118.01671],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Net Cash Flow',
                line: {color: '#003865', width: 3},
                marker: {size: 6}
            }
        ], {
            height: 400,
            barmode: 'relative',
            margin: {t: 30, b: 60, l: 80, r: 30},
            xaxis: {title: 'Week', tickangle: -45},
            yaxis: {title: 'Amount (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified'
        }, {responsive: true});

        // Short-term Forecast Chart
        var lastHistDate = '2025-10-29';
        var lastHistVal = 3001118.01671;
        Plotly.newPlot('short-forecast-KR10', [
            {
                x: ["2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [-127042.62123, 1183056.73867, 38309.92448999913, -1005435.5901500001, -41755.33706999995, 28888.555129999935, -2508577.630210001, 3001118.01671],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            },
            {
                x: [lastHistDate].concat(["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"]),
                y: [lastHistVal].concat([-310270.88263585616, 571265.7653856329, -1734744.5618999428, 7361507.470515604]),
                type: 'scatter',
                mode: 'lines+markers',
                name: '1-Month Forecast',
                line: {color: '#68D2DF', width: 4},
                marker: {size: 12, symbol: 'diamond'},
                fill: 'tozeroy',
                fillcolor: 'rgba(104, 210, 223, 0.2)'
            }
        ], {
            height: 320,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.15, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Long-term Forecast Chart (Month-by-Month with different colors)
        var longForecastTraces = [
            {
                x: ["2025-08-13", "2025-08-20", "2025-08-27", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-08", "2025-10-15", "2025-10-22", "2025-10-29"],
                y: [47228.19777, -2436663.99064, 2290883.09642, -164066.64337, -127042.62123, 1183056.73867, 38309.92448999913, -1005435.5901500001, -41755.33706999995, 28888.555129999935, -2508577.630210001, 3001118.01671],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Historical',
                line: {color: '#003865', width: 3},
                marker: {size: 8}
            }
        ];
        
        // Add each month as a separate trace with different colors
        var monthColors = ['#68D2DF', '#C4D600', '#F0AB00', '#D0006F', '#3C1053', '#830051'];
        var monthlyData = [{"month_num": 1, "dates": ["2025-11-05", "2025-11-12", "2025-11-19", "2025-11-26"], "predictions": [832173.2707223892, 202827.76210075896, 761776.3858633465, 2050453.1569131417], "total": 3847230.5755996364, "cumulative": 3847230.5755996364, "color": "#68D2DF"}, {"month_num": 2, "dates": ["2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24"], "predictions": [968124.9265465188, 890128.3658033777, 1940457.62795797, 1622928.9338680254], "total": 5421639.854175892, "cumulative": 9268870.429775529, "color": "#C4D600"}, {"month_num": 3, "dates": ["2025-12-31", "2026-01-07", "2026-01-14", "2026-01-21"], "predictions": [810949.8868396252, 2281914.3693691627, 2065460.4832424917, 1817401.5290803402], "total": 6975726.2685316205, "cumulative": 16244596.69830715, "color": "#F0AB00"}, {"month_num": 4, "dates": ["2026-01-28", "2026-02-04", "2026-02-11", "2026-02-18"], "predictions": [1990931.4071440846, 1109190.0298815034, 1081275.3107553981, -73487.7653660703], "total": 4107908.9824149157, "cumulative": 20352505.680722065, "color": "#D0006F"}, {"month_num": 5, "dates": ["2026-02-25", "2026-03-04", "2026-03-11", "2026-03-18"], "predictions": [1781884.104857751, 1180846.9397485787, 814281.1615877992, 440412.1697200222], "total": 4217424.375914151, "cumulative": 24569930.056636214, "color": "#3C1053"}, {"month_num": 6, "dates": ["2026-03-25", "2026-04-01", "2026-04-08", "2026-04-15"], "predictions": [2512752.13031165, 819805.666601237, 737495.2141897511, 623226.2744220432], "total": 4693279.285524681, "cumulative": 29263209.342160895, "color": "#830051"}];
        var prevEndDate = lastHistDate;
        var prevEndVal = lastHistVal;
        
        monthlyData.forEach(function(month, idx) {
            var xVals = [prevEndDate].concat(month.dates);
            var yVals = [prevEndVal].concat(month.predictions);
            longForecastTraces.push({
                x: xVals,
                y: yVals,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Month ' + month.month_num,
                line: {color: monthColors[idx], width: 3},
                marker: {size: 10, symbol: idx % 2 === 0 ? 'diamond' : 'circle'},
                fill: 'tozeroy',
                fillcolor: monthColors[idx] + '20'
            });
            prevEndDate = month.dates[month.dates.length - 1];
            prevEndVal = month.predictions[month.predictions.length - 1];
        });
        
        Plotly.newPlot('long-forecast-KR10', longForecastTraces, {
            height: 350,
            margin: {t: 30, b: 50, l: 70, r: 30},
            xaxis: {title: 'Week', tickangle: -30},
            yaxis: {title: 'Net Cash Flow (USD)', tickformat: ',.0f'},
            legend: {x: 0, y: 1.2, orientation: 'h'},
            hovermode: 'x unified',
            shapes: [{type: 'line', x0: lastHistDate, x1: lastHistDate, y0: 0, y1: 1, yref: 'paper', line: {color: '#888', width: 2, dash: 'dash'}}]
        }, {responsive: true});

        // Monthly Summary Bar Chart
        var monthlyTotals = monthlyData.map(m => m.total);
        var monthlyLabels = monthlyData.map(m => 'Month ' + m.month_num);
        var monthlyBarColors = monthlyTotals.map((v, i) => v >= 0 ? monthColors[i] : '#D0006F');
        
        Plotly.newPlot('monthly-chart-KR10', [
            {
                x: monthlyLabels,
                y: monthlyTotals,
                type: 'bar',
                marker: {color: monthlyBarColors},
                text: monthlyTotals.map(v => v >= 0 ? '+' + (v/1000).toFixed(0) + 'K' : (v/1000).toFixed(0) + 'K'),
                textposition: 'outside',
                hovertemplate: 'Month %{x}<br>Net: %{y:,.0f}<extra></extra>'
            },
            {
                x: monthlyLabels,
                y: monthlyData.map(m => m.cumulative),
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Cumulative',
                yaxis: 'y2',
                line: {color: '#003865', width: 3},
                marker: {size: 10}
            }
        ], {
            height: 300,
            margin: {t: 30, b: 50, l: 70, r: 70},
            xaxis: {title: ''},
            yaxis: {title: 'Monthly Net (USD)', tickformat: ',.0f'},
            yaxis2: {title: 'Cumulative (USD)', overlaying: 'y', side: 'right', tickformat: ',.0f'},
            showlegend: true,
            legend: {x: 0.5, y: 1.15, orientation: 'h', xanchor: 'center'},
            hovermode: 'x unified'
        }, {responsive: true});
        </script>
        

    </main>

    <footer style="text-align: center; padding: 2rem; color: #6c757d; font-size: 0.9rem;">
        <p>üè¢ Global Finance Services & Group Controllers | Cash Flow Analytics Platform</p>
        <p style="margin-top: 0.5rem;">Dashboard generated using Python ML Pipeline with AstraZeneca Theme</p>
    </footer>
</body>
</html>